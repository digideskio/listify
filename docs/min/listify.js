function dropdownselect(){var i=document.getElementById("playlistchooser"),s=i.options[i.selectedIndex].value;selectedlist=s,"..."===selectedlist?($("#playlistname").html('<span id="noplaylist">No selection</span>'),$("#printdisabled").show(),$("#copydisabled").show(),$("#trackcount").hide(),$("#printout").hide(),noselection()):($("#trackcount").show(),$("#printout").show(),$("#printdisabled").hide(),$("#copydisabled").hide(),chosenlookup())}function chosenlookup(){playlistid="",$.each(plistarray,function(i,l){var o=l.name;o==selectedlist&&(playlistid=l.id,$("#playlistname").html(selectedlist),$("#playlistname").succinct({size:70}),$("#noplaylist").hide())}),$.ajax({url:"https://api.spotify.com/v1/users/"+globaluser+"/playlists/"+playlistid+"/tracks",headers:{Authorization:"Bearer "+globaltoken},dataType:"json",success:function(i){var l=[];for(var o in i.items){var n=i.items[o].track.artists[0].name,r=i.items[o].track.name,c={artist:n,title:r};l.push(c)}tracklist=[],globaltracklist=tracklist;for(var o in l){var p=l[o].artist+" - "+l[o].title+"<br>";tracklist.push(p)}$("#textlist").slideToggle("slow",function(){$("#textlist").css("height","auto"),$("#textlist").html(tracklist),$("#textlist").slideToggle("slow")})},error:function(i){console.log(i)}})}function noselection(){$("#playlistname").html('<span id="noplaylist">No selection</span>'),$("#textlist").slideToggle("slow",function(){$("#textlist").css("height","300px"),$("#textlist").html('<div id="listplaceholder">Your track listing will appear here once you\'ve chosen a playlist.</div>'),$("#textlist").slideToggle("slow")})}function printout(){$("#textlist").printThis({pageTitle:selectedlist,importCSS:!1})}selectedlist=[],plistarray=[],playlistid=[],globaltoken=[],globaluser=[],globaluserurl=[],trackarray=[],globaltracklist=[];var clipboard=new Clipboard("#selectbutton");$("#trackcount").html('<span id="selectbutton" data-clipboard-target="#textlist" alt="Copy tracklist to the clipboard"><i class="fa fa-clipboard" aria-hidden="true"></i> Copy track list</span><span id="copied"><i class="fa fa-check" aria-hidden="true"></i> Copied to clipboard!</span>'),$("#printout").html('<span id="printbutton" onClick="printout();"><i class="fa fa-print" aria-hidden="true"></i> Print track list</span>'),$("#trackcount").hide(),$("#printout").hide(),clipboard.on("success",function(e){$("#printout").hide(),e.clearSelection(),$("#copied").fadeIn(500),$("#copied").delay(1e3).fadeOut(500),$("#printout").delay(2e3).fadeIn()}),function(){function i(i){function l(i){return"https://accounts.spotify.com/authorize?client_id="+o+"&redirect_uri="+encodeURIComponent(n)+"&scope="+encodeURIComponent(i.join(" "))+"&response_type=token"}var o="158e2387ffb542b69d48b22229187dc3",n="https://listify.thefuzz.xyz/auth.html",r=l(["user-read-email","playlist-read-private","playlist-read-collaborative"]),c=450,p=730,d=screen.width/2-c/2,u=screen.height/2-p/2;window.addEventListener("message",function(l){var o=JSON.parse(l.data);"access_token"==o.type&&i(o.access_token)},!1);window.open(r,"Spotify","menubar=no,location=no,resizable=no,scrollbars=no,status=no, width="+c+", height="+p+", top="+u+", left="+d)}function l(i){return $.ajax({url:"https://api.spotify.com/v1/me",headers:{Authorization:"Bearer "+i}})}var o=document.getElementById("btn-login");$("#right").hide(),o.addEventListener("click",function(){i(function(i){l(i).then(function(l){var o=l.id,n=l.external_urls.spotify;globaluserurl.push(n);var r=l.images[0].url;globaltoken=i,globaluser=o,$.ajax({url:"https://api.spotify.com/v1/users/"+o+"/playlists?limit=50",headers:{Authorization:"Bearer "+i},success:function(i){var l=[];for(var c in i.items)if(i.items[c].owner.id===o&&i.items[c].tracks.total>0){var p=i.items[c].name,d=i.items[c].id,u={name:p,id:d};plistarray.push(u),l.push(p)}$("#prelogin, footer, header, splogo").fadeOut("slow",function(){$("#left").css({width:"50%","float":"left"}),$("#splogo").hide(),$("#container").css({width:"100%",flex:""}),$("#wrapper").css({display:"","align-items":"","min-height":"","justify-content":""}),$("#right").fadeIn("slow"),$("#usernameleft").html('<a href="'+n+'" target="_blank">'+o+"</a>"),$("#userimage").html('<img src="'+r+'" class="img-circle">'),$("#postlogin").fadeIn("slow"),$("footer, header").fadeIn("slow")}),$("#choosebox").html('<select id="playlistchooser"><option>...</option></select>'),$("#playlistname").html('<span id="noplaylist">No selection</span>'),$("#playlistname").fadeIn(),$("#playlistchooser").selectmenu({change:function(){dropdownselect()}});for(var h=document.getElementById("playlistchooser"),f=l,g=0;g<f.length;g++){var b=f[g],k=document.createElement("option");k.textContent=b,k.value=b,h.appendChild(k)}}})})})})}();
